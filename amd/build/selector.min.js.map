{"version":3,"file":"selector.min.js","sources":["../src/selector.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JavaScript for child selector and zoom filter in Custom Dashboard block.\n *\n * @module     block_customdashboard/selector\n * @copyright  2026\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery'], function($) {\n    return {\n        init: function() {\n            // Child selector for parents.\n            $('#child-selector').on('change', function() {\n                const selectedChildId = $(this).val();\n                const currentUrl = new URL(window.location.href);\n                currentUrl.searchParams.set('selectedchild', selectedChildId);\n                window.location.href = currentUrl.toString();\n            });\n\n            // View child profile button.\n            $('#view-child-profile').on('click', function(e) {\n                e.preventDefault();\n                const selectedChildId = $('#child-selector').val();\n                if (selectedChildId) {\n                    const profileUrl = M.cfg.wwwroot + '/user/profile.php?id=' + selectedChildId;\n                    window.open(profileUrl, '_blank');\n                }\n            });\n\n            // Zoom classes filter.\n            $('#zoom-filter').on('change', function() {\n                const filterValue = $(this).val();\n                filterZoomClasses(filterValue);\n            });\n\n            /**\n             * Filter zoom classes based on selected option.\n             * @param {string} filter - The filter value ('today' or 'upcoming')\n             */\n            function filterZoomClasses(filter) {\n                const todayStart = new Date();\n                todayStart.setHours(0, 0, 0, 0);\n                const todayStartTimestamp = Math.floor(todayStart.getTime() / 1000);\n                const todayEnd = new Date();\n                todayEnd.setHours(23, 59, 59, 999);\n                const todayEndTimestamp = Math.floor(todayEnd.getTime() / 1000);\n\n                const $items = $('.zoom-class-item');\n                let visibleCount = 0;\n\n                $items.each(function() {\n                    const $item = $(this);\n                    const timestamp = parseInt($item.data('timestamp'), 10);\n\n                    let show = false;\n                    if (filter === 'today') {\n                        // Show classes happening today.\n                        show = timestamp >= todayStartTimestamp && timestamp <= todayEndTimestamp;\n                    } else if (filter === 'upcoming') {\n                        // Show classes starting from tomorrow onwards (excludes today's classes).\n                        show = timestamp > todayEndTimestamp;\n                    }\n\n                    if (show) {\n                        $item.show();\n                        visibleCount++;\n                    } else {\n                        $item.hide();\n                    }\n                });\n\n                // Show/hide no classes message.\n                const $container = $('#zoom-classes-container');\n                const $noClassesMsg = $container.find('.no-zoom-classes-message');\n\n                if (visibleCount === 0) {\n                    if ($noClassesMsg.length === 0) {\n                        $container.find('.list-group').after(\n                            '<p class=\"text-muted no-zoom-classes-message\">No zoom classes found.</p>'\n                        );\n                    }\n                    $container.find('.list-group').hide();\n                } else {\n                    $noClassesMsg.remove();\n                    $container.find('.list-group').show();\n                }\n            }\n\n            // Initialize with default filter on page load.\n            if ($('#zoom-filter').length > 0) {\n                const defaultFilter = $('#zoom-filter').val();\n                filterZoomClasses(defaultFilter);\n            }\n        }\n    };\n});\n"],"names":["define","$","init","filterZoomClasses","filter","todayStart","Date","setHours","todayStartTimestamp","Math","floor","getTime","todayEnd","todayEndTimestamp","$items","visibleCount","each","$item","this","timestamp","parseInt","data","show","hide","$container","$noClassesMsg","find","length","after","remove","on","selectedChildId","val","currentUrl","URL","window","location","href","searchParams","set","toString","e","preventDefault","profileUrl","M","cfg","wwwroot","open"],"mappings":";;;;;;;AAuBAA,wCAAO,CAAC,WAAW,SAASC,SACjB,CACHC,KAAM,oBA6BOC,kBAAkBC,cACjBC,WAAa,IAAIC,KACvBD,WAAWE,SAAS,EAAG,EAAG,EAAG,SACvBC,oBAAsBC,KAAKC,MAAML,WAAWM,UAAY,KACxDC,SAAW,IAAIN,KACrBM,SAASL,SAAS,GAAI,GAAI,GAAI,WACxBM,kBAAoBJ,KAAKC,MAAME,SAASD,UAAY,KAEpDG,OAASb,EAAE,wBACbc,aAAe,EAEnBD,OAAOE,MAAK,iBACFC,MAAQhB,EAAEiB,MACVC,UAAYC,SAASH,MAAMI,KAAK,aAAc,QAEhDC,MAAO,EACI,UAAXlB,OAEAkB,KAAOH,WAAaX,qBAAuBW,WAAaN,kBACtC,aAAXT,SAEPkB,KAAOH,UAAYN,mBAGnBS,MACAL,MAAMK,OACNP,gBAEAE,MAAMM,gBAKRC,WAAavB,EAAE,2BACfwB,cAAgBD,WAAWE,KAAK,4BAEjB,IAAjBX,cAC6B,IAAzBU,cAAcE,QACdH,WAAWE,KAAK,eAAeE,MAC3B,4EAGRJ,WAAWE,KAAK,eAAeH,SAE/BE,cAAcI,SACdL,WAAWE,KAAK,eAAeJ,WAxEvCrB,EAAE,mBAAmB6B,GAAG,UAAU,iBACxBC,gBAAkB9B,EAAEiB,MAAMc,MAC1BC,WAAa,IAAIC,IAAIC,OAAOC,SAASC,MAC3CJ,WAAWK,aAAaC,IAAI,gBAAiBR,iBAC7CI,OAAOC,SAASC,KAAOJ,WAAWO,cAItCvC,EAAE,uBAAuB6B,GAAG,SAAS,SAASW,GAC1CA,EAAEC,uBACIX,gBAAkB9B,EAAE,mBAAmB+B,SACzCD,gBAAiB,OACXY,WAAaC,EAAEC,IAAIC,QAAU,wBAA0Bf,gBAC7DI,OAAOY,KAAKJ,WAAY,cAKhC1C,EAAE,gBAAgB6B,GAAG,UAAU,WAE3B3B,kBADoBF,EAAEiB,MAAMc,UA0D5B/B,EAAE,gBAAgB0B,OAAS,EAAG,CAE9BxB,kBADsBF,EAAE,gBAAgB+B"}